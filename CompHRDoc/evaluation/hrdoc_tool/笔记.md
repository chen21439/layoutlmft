# HRDoc Evaluation Tool / HRDoc 评估工具

This directory contains the evaluation toolkit for Comp-HRDoc benchmark.

本目录包含 Comp-HRDoc 基准测试的评估工具包。

## Evaluation Scripts / 评估脚本

| File / 文件 | Task / 任务 | Metric / 指标 |
|-------------|-------------|---------------|
| `page_object_detection_eval.py` | Page Object Detection / 页面对象检测 | COCO mAP |
| `reading_order_eval.py` | Reading Order Prediction / 阅读顺序预测 | Edit Distance / 编辑距离 |
| `teds_eval.py` | Hierarchical Structure Reconstruction / 层次结构重建 | TEDS (Tree Edit Distance-based Similarity) |
| `classify_eval.py` | Logical Role Classification / 逻辑角色分类 | F1-score |

## Utility Files / 工具文件

| File / 文件 | Description / 描述 |
|-------------|---------------------|
| `doc_utils.py` | Document tree operations: APTED tree edit distance, tree visualization, Node class definition / 文档树操作：APTED 树编辑距离计算、树可视化、节点类定义 |
| `utils.py` | General utilities: LaTeX parsing, PDF processing, text matching, visualization / 通用工具：LaTeX 解析、PDF 处理、文本匹配、可视化 |
| `data_postprocess.py` | Data postprocessing: convert model outputs to evaluation format, build tree structures / 数据后处理：将模型输出转换为评估格式、构建树结构 |

## File Dependencies / 文件依赖关系

```
Evaluation Scripts / 评估脚本
    ├── page_object_detection_eval.py  ← pycocotools
    ├── reading_order_eval.py          ← doc_utils
    ├── teds_eval.py                   ← doc_utils (APTED)
    └── classify_eval.py               ← sklearn + utils

Utility Files / 工具文件
    ├── doc_utils.py   ← Core: tree structure, TEDS / 核心：树结构、TEDS 计算
    ├── utils.py       ← Base: text processing, visualization / 基础：文本处理、可视化
    └── data_postprocess.py ← Format conversion / 格式转换
```

## Logical Role Classes / 逻辑角色分类

Defined in `classify_eval.py` / 定义于 `classify_eval.py`：

| ID | Class / 类别 | Description / 描述 |
|----|--------------|---------------------|
| 0 | title | Title / 标题 |
| 1 | author | Author / 作者 |
| 2 | mail | Email / 邮箱 |
| 3 | affili | Affiliation / 机构 |
| 4 | section | Section heading / 章节标题 |
| 5 | fstline | First line of paragraph / 段落首行 |
| 6 | paraline | Paragraph line / 段落行 |
| 7 | table | Table / 表格 |
| 8 | figure | Figure / 图片 |
| 9 | caption | Caption / 图表标题 |
| 10 | equation | Equation / 公式 |
| 11 | footer | Footer / 页脚 |
| 12 | header | Header / 页眉 |
| 13 | footnote | Footnote / 脚注 |

## Usage Examples / 使用示例

### Page Object Detection Evaluation / 页面对象检测评估

```bash
python page_object_detection_eval.py \
    --gt_anno path/to/coco_test.json \
    --pred_folder path/to/det_json/
```

### Reading Order Evaluation / 阅读顺序评估

```bash
python reading_order_eval.py \
    --gt_folder path/to/gt_reading_order/ \
    --pred_folder path/to/pred_reading_order/
```

### Hierarchical Structure Evaluation (TEDS) / 层次结构评估

```bash
python teds_eval.py \
    --gt_anno path/to/test_eval/ \
    --pred_folder path/to/hr_json/
```

### Classification Evaluation / 分类评估

```bash
python classify_eval.py \
    --gt_folder path/to/gt_folder/ \
    --pred_folder path/to/pred_folder/
```
