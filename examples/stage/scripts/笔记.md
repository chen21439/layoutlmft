# 训练
```shell
  python examples/stage/train_joint.py \
      --env test \
      --min_steps 1000  \
      --gradient_checkpointing  \
      --per_device_train_batch_size 1 \
      --model_path /data/LLM_group/layoutlmft/artifact/exp_20251226_145417/joint_tender/checkpoint-25 \
      --use_soft_mask true \
      --freeze_visual \
      --dataset tender \
      --covmatch doc_random_dev6_seed99 \
      --eval_before_train \
      --stage1_no_grad true  \
      > logs/train_joint_$(date +%Y%m%d_%H%M%S).log 2>&1 &
      
        python examples/stage/train_joint.py \
      --env test \
      --min_steps 1000  \
      --gradient_checkpointing  \
      --stage1_no_grad false  \
      --per_device_train_batch_size 1 \
      --model_path /data/LLM_group/layoutlmft/artifact/exp_20251226_145417/joint_hrds/checkpoint-1075 \
      --use_soft_mask true \
      --freeze_visual \
      --gpu 1  \
      --dataset hrdh \
      ----covmatch doc_covmatch_dev12_seed42 \
      > logs/train_joint_$(date +%Y%m%d_%H%M%S).log 2>&1 &
      
            
            --new_exp
            --freeze_visual \
```

# covmatch

```shell
  python examples/stage/scripts/create_dev_covmatch.py \
    --env test --dataset tender --mode random --dev_count 6 --seed 99

python examples/stage/scripts/create_dev_covmatch.py --env test \
  --dataset hrdh --dev_ratio 0.125 --seed 42
```

# 推理

```shell
  python examples/infer/run_joint_infer.py \
      --env test \
      --dataset tender \
      --model_path /data/LLM_group/layoutlmft/artifact/exp_20251226_145417/joint_hrds/checkpoint-1225 \
      --gpu 7
      
            --skip_eval
```